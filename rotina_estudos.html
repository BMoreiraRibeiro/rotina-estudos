<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rotina de Estudos - Exames Janeiro 2025</title>
    <!-- Inline SVG favicon (same as main page) -->
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%238b5cf6'/%3E%3Ctext x='50' y='60' font-size='56' text-anchor='middle' fill='white'%3E%F0%9F%93%9A%3C/text%3E%3C/svg%3E">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #0f1624;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            border: 1px solid #1e293b;
        }
        
        h1 {
            color: #8b5cf6;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        h2 {
            color: #a78bfa;
        }
        
        h3 {
            color: #c4b5fd;
        }
        
        .subtitle {
            text-align: center;
            color: #94a3b8;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        
        .progress-section {
            background: #1e293b;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 1px solid #334155;
        }
        
        .progress-item {
            margin-bottom: 15px;
        }
        
        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-weight: 600;
            color: #e2e8f0;
        }
        
        .progress-bar-container {
            width: 100%;
            height: 25px;
            background: #334155;
            border-radius: 12px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #8b5cf6, #a78bfa);
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.9em;
        }
        
        .week-schedule {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .day-card {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(139, 92, 246, 0.3);
        }
        
        .day-card h3 {
            margin-bottom: 15px;
            font-size: 1.3em;
            border-bottom: 2px solid rgba(255,255,255,0.3);
            padding-bottom: 10px;
        }
        
        .study-block {
            background: rgba(255,255,255,0.15);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            position: relative;
        }
        
        .study-block:hover {
            background: rgba(255,255,255,0.25);
            transform: translateY(-2px);
        }
        
        .study-block.completed {
            background: rgba(34, 197, 94, 0.3);
            text-decoration: line-through;
        }
        
        .study-block.has-notes {
            border-left: 4px solid #fbbf24;
        }
        
        .notes-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(139, 92, 246, 0.8);
            color: white;
            border: none;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
        }
        
        .notes-btn:hover {
            background: rgba(139, 92, 246, 1);
            transform: scale(1.1);
        }
        
        .notes-btn.has-content {
            background: #fbbf24;
        }
        
        .time {
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
        }
        
        .subject {
            font-size: 0.95em;
        }
        
        .tips-section {
            background: #1e293b;
            border-left: 4px solid #8b5cf6;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 1px solid #334155;
        }
        
        .notes-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .notes-modal.open {
            display: flex;
        }
        
        .notes-content {
            background: #0f1624;
            padding: 30px;
            border-radius: 15px;
            max-width: 600px;
            width: 90%;
            border: 1px solid #334155;
        }
        
        .notes-content h3 {
            color: #a78bfa;
            margin-bottom: 15px;
        }
        
        .notes-content textarea {
            width: 100%;
            min-height: 200px;
            background: #1e293b;
            color: #e2e8f0;
            border: 1px solid #334155;
            border-radius: 8px;
            padding: 12px;
            font-family: inherit;
            font-size: 14px;
            resize: vertical;
        }
        
        .notes-content textarea:focus {
            outline: none;
            border-color: #8b5cf6;
        }
        
        .notes-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .notes-actions button {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
        }
        
        .notes-actions .save-btn {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }
        
        .notes-actions .cancel-btn {
            background: #475569;
            color: white;
        }
        
        .tips-section h3 {
            color: #a78bfa;
            margin-bottom: 15px;
        }
        
        .tips-section ul {
            margin-left: 20px;
        }
        
        .tips-section li {
            margin-bottom: 8px;
            color: #e2e8f0;
        }
        
        .tips-section strong {
            color: #fbbf24;
        }
        
        /* Specific color schemes for different tip sections */
        .tips-section.green-theme {
            background: #d1fae5;
            border-left-color: #10b981;
            border-color: #10b981;
        }
        
        .tips-section.green-theme h3 {
            color: #065f46;
        }
        
        .tips-section.green-theme li {
            color: #047857;
        }
        
        .tips-section.green-theme strong {
            color: #065f46;
        }
        
        .tips-section.yellow-theme {
            background: #fef3c7;
            border-left-color: #f59e0b;
            border-color: #f59e0b;
        }
        
        .tips-section.yellow-theme h3 {
            color: #92400e;
        }
        
        .tips-section.yellow-theme li {
            color: #78350f;
        }
        
        .tips-section.yellow-theme strong {
            color: #92400e;
        }
        
        .tips-section.blue-theme {
            background: #1e3a8a;
            border-left-color: #3b82f6;
            border-color: #3b82f6;
        }
        
        .tips-section.blue-theme h3 {
            color: #93c5fd;
        }
        
        .tips-section.blue-theme li {
            color: #dbeafe;
        }
        
        .tips-section.blue-theme strong {
            color: #60a5fa;
        }
        
        .countdown {
            text-align: center;
            background: linear-gradient(135deg, #dc2626 0%, #ef4444 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(220, 38, 38, 0.3);
        }
        
        .countdown-number {
            font-size: 3em;
            font-weight: bold;
            display: block;
        }
        
        .rotation-schedule {
            background: #1e293b;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            border: 1px solid #334155;
        }
        
        .rotation-schedule h3 {
            color: #a78bfa;
            margin-bottom: 15px;
        }
        
        .rotation-item {
            background: #0f1624;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #8b5cf6;
        }
        
        .week-label {
            font-weight: bold;
            color: #a78bfa;
            margin-bottom: 5px;
        }
        
        button {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1em;
            cursor: pointer;
            transition: transform 0.2s;
            margin: 5px;
            box-shadow: 0 4px 10px rgba(139, 92, 246, 0.3);
        }
        
        button:hover {
            transform: scale(1.05);
        }
        
        .button-group {
            text-align: center;
            margin-top: 20px;
        }
        
        select {
            background: #1e293b;
            color: #e2e8f0;
            border: 2px solid #8b5cf6;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 1em;
            cursor: pointer;
        }
        
        select option {
            background: #1e293b;
            color: #e2e8f0;
        }
        
        a {
            color: #a78bfa;
        }
        
        /* PESTA task styles removed (section not used on this page) */
    </style>
</head>
<body>
    <div class="container">
        <h1>üìö Rotina de Estudos</h1>
        <p class="subtitle">Exames: 19 Jan ‚ö°Magnetismo | 26 Jan üîåPot√™ncia | 28 Jan üåäVIBON</p>
        
        <div class="countdown">
            <span class="countdown-number" id="daysLeft">--</span>
            <span>dias at√© o 1¬∫ exame (19 Jan)</span>
        </div>
        
        <!-- PESTA content removed from study page -->
        
        <div class="button-group">
            <button onclick="updateProgress(5)">‚úÖ Sess√£o Completa (+5%)</button>
            <button onclick="resetProgress()">üîÑ Reiniciar Progresso</button>
            <button onclick="downloadSchedule()">üíæ Guardar Plano</button>
            <button onclick="window.open('https://pomofocus.io/', '_blank')" style="background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);">‚è±Ô∏è Abrir Pomodoro Timer</button>
        </div>
        
        <div style="background: #422006; padding: 20px; border-radius: 15px; margin-top: 20px; margin-bottom: 30px; border-left: 4px solid #f59e0b; border: 1px solid #78350f;">
            <h3 style="color: #fcd34d; margin-bottom: 15px;">‚è±Ô∏è T√©cnica Pomodoro - Como Usar</h3>
            <div style="color: #fef3c7;">
                <p style="margin-bottom: 10px;"><strong>Para cada sess√£o de estudo (2h):</strong></p>
                <ul style="margin-left: 20px; margin-bottom: 15px;">
                    <li>üçÖ 25 minutos de estudo focado</li>
                    <li>‚òï 5 minutos de pausa</li>
                    <li>üîÅ Repetir 4 vezes</li>
                    <li>üéâ Pausa longa de 15-30 min ap√≥s 4 pomodoros</li>
                </ul>
                <p style="margin-bottom: 10px;"><strong>Durante os 25 minutos:</strong> Foco total! Telem√≥vel longe, notifica√ß√µes off.</p>
                <p style="margin-bottom: 10px;"><strong>Durante a pausa:</strong> Levanta-te, bebe √°gua, estica, olha para longe do ecr√£.</p>
                <p><a href="https://pomofocus.io/" target="_blank" style="color: #fcd34d; font-weight: bold; text-decoration: underline;">üëâ Clica aqui para abrir o Pomodoro Timer</a></p>
            </div>
        </div>
        
        <div class="progress-section">
            <h3 style="margin-bottom: 20px; color: #a78bfa;">üìä Progresso Geral</h3>
            <div class="progress-item">
                <div class="progress-label">
                    <span>‚ö° Eletromagnetismo</span>
                    <span id="electro-percent">0%</span>
                </div>
                <div class="progress-bar-container">
                    <div class="progress-bar" id="electro-bar" style="width: 0%">0%</div>
                </div>
            </div>
            <div class="progress-item">
                <div class="progress-label">
                    <span>üîå Eletr√≥nica de Pot√™ncia</span>
                    <span id="power-percent">0%</span>
                </div>
                <div class="progress-bar-container">
                    <div class="progress-bar" id="power-bar" style="width: 0%">0%</div>
                </div>
            </div>
            <div class="progress-item">
                <div class="progress-label">
                    <span>üåä VIBON (Vibra√ß√µes e Ondas)</span>
                    <span id="vibon-percent">0%</span>
                </div>
                <div class="progress-bar-container">
                    <div class="progress-bar" id="vibon-bar" style="width: 0%">0%</div>
                </div>
            </div>
        </div>
        
        <!-- PESTA project section removed from this page -->
        
        <div class="rotation-schedule">
            <h3>üîÑ Plano Gradual de Estudos (Sem Press√£o!)</h3>
            
            <div style="background: #e8f5e9; padding: 15px; border-radius: 10px; margin-bottom: 15px; border-left: 4px solid #4caf50;">
                <div style="font-weight: bold; color: #2e7d32; margin-bottom: 10px;">üìÖ FASE 1: 8-21 Dez - ARRANQUE üöÄ</div>
                <div style="color: #2e7d32;">
                    <strong>Estrat√©gia:</strong> Regra dos 2 Minutos - come√ßa por tarefas pequenas!<br>
                    <strong>Ritmo:</strong> 1 conceito + 1 exerc√≠cio simples por sess√£o<br>
                    <strong>Objetivo:</strong> Quebrar in√©rcia! Come√ßar √© mais importante que acabar.<br>
                    <strong>Pomodoro:</strong> 25 min estudo + 5 min pausa (m√°x 2-3 pomodoros/dia)<br>
                    <strong>Dica:</strong> V√≠deos primeiro, depois apontamentos. N√ÉO for√ßes!
                </div>
            </div>
            
            <div style="background: #fff3cd; padding: 15px; border-radius: 10px; margin-bottom: 15px; border-left: 4px solid #ffc107;">
                <div style="font-weight: bold; color: #856404; margin-bottom: 10px;">üìÖ FASE 2: 22-28 Dez - NATAL üéÑ</div>
                <div style="color: #856404;">
                    <strong>Objetivo:</strong> Manter contacto com mat√©ria sem stress<br>
                    <strong>Ritmo:</strong> 1 Pomodoro por dia √© suficiente! Descanso = aprendizado<br>
                    <strong>Retrieval Practice:</strong> Tenta recordar o que aprendeste antes de rever<br>
                    <strong>Dica:</strong> Flashcards r√°pidos enquanto relaxas, sem press√£o<br>
                    <strong>Prioridade:</strong> Relat√≥rios VIBON (30 min/dia m√°x)
                </div>
            </div>
            
            <div style="background: #e3f2fd; padding: 15px; border-radius: 10px; margin-bottom: 15px; border-left: 4px solid #2196f3;">
                <div style="font-weight: bold; color: #1565c0; margin-bottom: 10px;">üìÖ FASE 3: 29 Dez - 11 Jan - SPRINT üí™</div>
                <div style="color: #1565c0;">
                    <strong>Objetivo:</strong> Pr√°tica intensiva! Auto-testes para consolidar<br>
                    <strong>Ritmo:</strong> 3-4 Pomodoros/dia, exerc√≠cios mais dif√≠ceis<br>
                    <strong>M√©todo Ivy Lee:</strong> 6 tarefas priorit√°rias na noite anterior<br>
                    <strong>Retrieval Practice:</strong> Faz exerc√≠cios SEM olhar para apontamentos primeiro<br>
                    <strong>Temptation Bundling:</strong> Recompensa-te ap√≥s cada sess√£o!
                </div>
            </div>
            
            <div style="background: #f3e5f5; padding: 15px; border-radius: 10px; margin-bottom: 15px; border-left: 4px solid #9c27b0;">
                <div style="font-weight: bold; color: #6a1b9a; margin-bottom: 10px;">üìÖ FASE 4: 12-18 Jan - REVIS√ÉO FINAL üìö</div>
                <div style="color: #6a1b9a;">
                    <strong>Objetivo:</strong> Consolida√ß√£o total! Exames antigos em modo simula√ß√£o<br>
                    <strong>Ritmo:</strong> Manh√£ = mat√©ria fraca | Tarde = pr√°tica de exames<br>
                    <strong>F√≥rmulas:</strong> Criar folha de f√≥rmulas resumida para cada cadeira<br>
                    <strong>√öltimas d√∫vidas:</strong> Pergunta a colegas/professores AGORA!
                </div>
            </div>
            
            <div style="background: #ffebee; padding: 15px; border-radius: 10px; border-left: 4px solid #f44336;">
                <div style="font-weight: bold; color: #c62828; margin-bottom: 10px;">‚≠ê EXAMES: 19-28 Jan - DIA D! üéØ</div>
                <div style="color: #c62828;">
                    <strong>19 Jan 14:30:</strong> ‚ö° Eletromagnetismo<br>
                    <strong>26 Jan:</strong> üîå Pot√™ncia<br>
                    <strong>28 Jan:</strong> üåä VIBON<br>
                    <strong>Entre exames:</strong> Revis√£o focada na pr√≥xima cadeira. Descanso √© importante!<br>
                    <strong>Na v√©spera:</strong> Revis√£o leve + boa noite de sono. N√£o estudar at√© tarde!
                </div>
            </div>
        </div>
        
        <h2 style="color: #667eea; margin-bottom: 20px;">üìÖ <span id="weekTitle">Semana 1 (8-14 Dez) - ARRANQUE üöÄ</span></h2>
        
        <div style="display: flex; justify-content: center; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
            <button onclick="changeWeek(-1)" style="background: #6c757d;">‚óÄ Semana Anterior</button>
            <select id="weekSelector" onchange="selectWeek()" style="padding: 12px 20px; border-radius: 25px; border: 2px solid #667eea; font-size: 1em; cursor: pointer;">
                <option value="0">Semana 1 (8-14 Dez) - ARRANQUE üöÄ</option>
                <option value="1">Semana 2 (15-21 Dez) - CONSTRUIR BASE</option>
                <option value="2">Semana 3 (22-28 Dez) - NATAL üéÑ</option>
                <option value="3">Semana 4 (29 Dez - 4 Jan) - SPRINT üí™</option>
                <option value="4">Semana 5 (5-11 Jan) - PR√ÅTICA ATIVA</option>
                <option value="5">Semana 6 (12-18 Jan) - REVIS√ÉO FINAL üìö</option>
                <option value="6">Semana 7 (19 Jan) - EXAME MAGNETISMO ‚ö°</option>
                <option value="7">Semana 8 (20-28 Jan) - EXAMES FINAIS üéØ</option>
            </select>
            <button onclick="changeWeek(1)" style="background: #6c757d;">Pr√≥xima Semana ‚ñ∂</button>
        </div>
        
        <div class="week-schedule" id="weekContent"></div>
        
        <div class="tips-section green-theme">
            <h3>üí° Estrat√©gias Anti-Ansiedade</h3>
            <ul>
                <li><strong>üêå Vai devagar:</strong> 1 conceito novo por sess√£o √© SUFICIENTE! N√£o tentes cobrir tudo de uma vez.</li>
                <li><strong>üîç Quando encravar:</strong> PARA! V√™ um v√≠deo diferente, procura outro exemplo, ou deixa para o dia seguinte. For√ßar n√£o funciona.</li>
                <li><strong>üì∫ V√≠deos primeiro:</strong> Antes de ler teoria pesada, v√™ 1-2 v√≠deos do YouTube. Ajuda a "pr√©-digerir" o conte√∫do.</li>
                <li><strong>‚úÖ Micro-vit√≥rias:</strong> Percebeste 1 conceito? CELEBRA! Fizeste 1 exerc√≠cio? CONTA! Progresso √© progresso.</li>
                <li><strong>üîÅ Repeti√ß√£o √© normal:</strong> Vais precisar VER o mesmo t√≥pico 2-3 vezes. Isso √© NORMAL em mat√©ria dif√≠cil!</li>
                <li><strong>üí¨ Pede ajuda cedo:</strong> N√£o percebeste? Pergunta a colegas/prof no dia seguinte. N√£o esperes ficar 100% perdido.</li>
                <li><strong>üß† Descanso = Aprendizado:</strong> O c√©rebro processa durante o sono. √Äs vezes dormir resolve mais que estudar mais 1h.</li>
            </ul>
        </div>
        
        <div class="tips-section green-theme">
            <h3>üéØ Abordagem Realista por Disciplina</h3>
            <ul>
                <li><strong>‚ö° Eletromagnetismo:</strong> Come√ßa pelos V√çDEOS (MIT, Khan Academy). A teoria matem√°tica fica mais clara depois de ver aplica√ß√µes pr√°ticas.</li>
                <li><strong>üîå Pot√™ncia (a mais visual!):</strong> DESENHA os circuitos enquanto estudas. Usa simuladores (LTSpice √© gr√°tis) para VER as formas de onda antes de calcular.</li>
                <li><strong>üåä VIBON:</strong> Relat√≥rios podem ser feitos AOS POUCOS durante a semana (30 min por dia). N√£o precisa ser tudo de uma vez!</li>
                <li><strong>Exerc√≠cios:</strong> SEMPRE consulta exemplos resolvidos primeiro. Depois tenta fazer similar. N√£o h√° vergonha em copiar para aprender!</li>
            </ul>
        </div>
        
        <div class="tips-section yellow-theme">
            <h3>‚è∞ Gest√£o de Tempo - 8 Semanas at√© Exames</h3>
            <ul>
                <li><strong>Semanas 1-2 (8-21 Dez):</strong> ARRANQUE! Tarefas de 2 minutos para quebrar in√©rcia. Um conceito de cada vez.</li>
                <li><strong>Semana 3 (22-28 Dez - Natal):</strong> Ritmo mais leve. Mant√©m contacto com mat√©ria, sem press√£o excessiva.</li>
                <li><strong>Semanas 4-5 (29 Dez - 11 Jan):</strong> SPRINT! Exerc√≠cios com mais autonomia, pr√°tica ativa, auto-testes.</li>
                <li><strong>Semana 6 (12-18 Jan - REVIS√ÉO FINAL):</strong> Exames antigos, f√≥rmulas, √∫ltimas d√∫vidas!</li>
                <li><strong>Semana 7-8 (19-28 Jan - EXAMES):</strong> 19 Jan ‚ö°Magnetismo | 26 Jan üîåPot√™ncia | 28 Jan üåäVIBON</li>
                <li><strong>Se atrasares:</strong> Prioriza Pot√™ncia (mais peso) > Eletromag > VIBON. Ajusta o plano!</li>
            </ul>
        </div>
        
        <div class="tips-section blue-theme">
            <h3>üìö Recursos Espec√≠ficos por T√≥pico</h3>
            <ul>
                <li><strong>Eletromagnetismo - Teorema de Gauss:</strong> MIT OpenCourseWare "8.02 Electricity and Magnetism", Khan Academy Electric Charge</li>
                <li><strong>Eletromagnetismo - Maxwell:</strong> YouTube "Maxwell's Equations" by 3Blue1Brown, apontamentos do prof</li>
                <li><strong>Pot√™ncia - Conversores:</strong> V√≠deos "Power Electronics" - Sam Ben-Yaakov (Israel), simula√ß√µes LTSpice</li>
                <li><strong>Pot√™ncia - Formas de Onda:</strong> Praticar com simulador PSIM ou LTSpice, fazer √† m√£o depois!</li>
                <li><strong>VIBON - MHS:</strong> Khan Academy "Simple Harmonic Motion", Walter Lewin MIT</li>
                <li><strong>VIBON - Ondas EM:</strong> Os mesmos v√≠deos de Maxwell servem + "EM waves" MIT</li>
                <li><strong>VIBON - √ìptica:</strong> "Physics of Light and Color" - Don Pettit, exerc√≠cios de Lei de Snell</li>
                <li><strong>Ferramentas:</strong> Wolfram Alpha (verificar c√°lculos), Anki (flashcards de f√≥rmulas), Notion/OneNote (resumos)</li>
            </ul>
        </div>
        
        <div class="tips-section yellow-theme">
            <h3>üìù Checklist de F√≥rmulas Essenciais</h3>
            <ul>
                <li><strong>Eletromag:</strong> Lei Coulomb, E=‚àáV, ‚àá¬∑E=œÅ/Œµ‚ÇÄ, ‚àá√óE=-‚àÇB/‚àÇt, ‚àá¬∑B=0, ‚àá√óB=Œº‚ÇÄJ+Œº‚ÇÄŒµ‚ÇÄ‚àÇE/‚àÇt</li>
                <li><strong>Pot√™ncia:</strong> Vo_Buck=D¬∑Vin, Vo_Boost=Vin/(1-D), P=V¬∑I¬∑cosœÜ, THD formula</li>
                <li><strong>VIBON:</strong> œâ=2œÄf, v=Œªf, y(x,t)=Asin(kx-œât), n‚ÇÅsinŒ∏‚ÇÅ=n‚ÇÇsinŒ∏‚ÇÇ, Œª_m√≠n=a¬∑sinŒ∏</li>
                <li>Cria um cart√£o com estas f√≥rmulas e rev√™ 5 min por dia!</li>
            </ul>
        </div>
    </div>
    
    <!-- Notes Modal -->
    <div id="notesModal" class="notes-modal">
        <div class="notes-content">
            <h3>üìù Notas da Sess√£o</h3>
            <textarea id="notesTextarea" placeholder="Adiciona aqui as tuas notas, d√∫vidas, ou observa√ß√µes sobre esta sess√£o de estudo..."></textarea>
            <div class="notes-actions">
                <button class="save-btn" onclick="saveNotes()">üíæ Guardar</button>
                <button class="cancel-btn" onclick="closeNotes()">‚ùå Cancelar</button>
            </div>
        </div>
    </div>
    
    <!-- Firebase Configuration (external file) -->
    <script src="firebase-config.js"></script>
    
    <script>
        // ===== FIREBASE INITIALIZATION =====
        let db = null;
        let firebaseEnabled = false;
        
        try {
            firebase.initializeApp(firebaseConfig);
            db = firebase.firestore();
            firebaseEnabled = true;
            console.log('‚úÖ Firebase conectado (Rotina Estudos)');
        } catch (error) {
            console.warn('‚ö†Ô∏è Firebase n√£o configurado. Usando localStorage apenas.', error);
            firebaseEnabled = false;
        }
        
        // ===== STUDY SCHEDULE =====
        // Nova rotina: 8 Dez 2025 ‚Üí 28 Jan 2026
        // Exames: 19 Jan Magnetismo | 26 Jan Pot√™ncia | 28 Jan VIBON
        // Baseado em: Regra 2-min, Ivy Lee, Spaced Repetition, Retrieval Practice, blocos curtos
        const weeks = [
            // Semana 1: 8-14 Dez ‚Äî ARRANQUE (baby steps)
            {
                title: "Semana 1 (8-14 Dez) ‚Äî Arranque üöÄ",
                days: [
                    {
                        name: "Segunda 8 Dez",
                        blocks: [
                            { time: "üéØ 2 min start", subject: "‚ö° MAGNETISMO<br>‚Ä¢ Abre os apontamentos<br>‚Ä¢ L√™ 1 p√°gina s√≥<br>‚Ä¢ FEITO = Vit√≥ria!" },
                            { time: "25 min", subject: "‚ö° Lei de Coulomb<br>‚Ä¢ Ver 1 v√≠deo curto<br>‚Ä¢ Escreve 3 ideias-chave<br>‚Ä¢ Sem press√£o!" }
                        ]
                    },
                    {
                        name: "Ter√ßa 9 Dez",
                        blocks: [
                            { time: "üéØ 2 min start", subject: "üîå POT√äNCIA<br>‚Ä¢ Abre o material<br>‚Ä¢ Olha √≠ndice/sum√°rio<br>‚Ä¢ Escolhe 1 t√≥pico" },
                            { time: "25 min", subject: "üîå Revis√£o CA<br>‚Ä¢ Fasores b√°sicos<br>‚Ä¢ 1 v√≠deo explicativo<br>‚Ä¢ Anota d√∫vidas" }
                        ]
                    },
                    {
                        name: "Quarta 10 Dez",
                        blocks: [
                            { time: "üéØ 2 min start", subject: "üåä VIBON<br>‚Ä¢ Abre livro/slides<br>‚Ä¢ L√™ introdu√ß√£o MHS<br>‚Ä¢ S√≥ familiarizar" },
                            { time: "25 min", subject: "üåä MHS b√°sico<br>‚Ä¢ x(t) = A cos(œât + œÜ)<br>‚Ä¢ Ver anima√ß√£o/v√≠deo<br>‚Ä¢ Desenha 1 gr√°fico" }
                        ]
                    },
                    {
                        name: "Quinta 11 Dez",
                        blocks: [
                            { time: "üîÅ Retrieval", subject: "‚ö° TESTE: Coulomb<br>‚Ä¢ Fecha tudo<br>‚Ä¢ Escreve o que lembras<br>‚Ä¢ Depois confere" }
                        ]
                    },
                    {
                        name: "Sexta 12 Dez",
                        blocks: [
                            { time: "üîÅ Retrieval", subject: "üîå TESTE: CA<br>‚Ä¢ Fecha tudo<br>‚Ä¢ Desenha fasor de cor<br>‚Ä¢ Confere depois" }
                        ]
                    },
                    {
                        name: "Fim de Semana 13-14",
                        blocks: [
                            { time: "1-2h S√°b", subject: "üìù Revis√£o leve<br>‚Ä¢ Reler notas da semana<br>‚Ä¢ Fazer 2 exerc√≠cios<br>‚Ä¢ Premeia-te depois! üç´" },
                            { time: "Dom opcional", subject: "üßò Descanso ativo<br>‚Ä¢ Ver v√≠deo relacionado<br>‚Ä¢ Ou descansar<br>‚Ä¢ Recarregar √© OK!" }
                        ]
                    }
                ]
            },
            // Semana 2: 15-21 Dez ‚Äî Construir Base
            {
                title: "Semana 2 (15-21 Dez) ‚Äî Base s√≥lida üß±",
                days: [
                    {
                        name: "Segunda 15 Dez",
                        blocks: [
                            { time: "25 min", subject: "‚ö° Campo El√©trico E<br>‚Ä¢ E = F/q conceito<br>‚Ä¢ Ver exerc√≠cio resolvido<br>‚Ä¢ Tentar 1 sozinho" },
                            { time: "25 min", subject: "‚ö° Gauss Intro<br>‚Ä¢ O que √© fluxo?<br>‚Ä¢ Superf√≠cie gaussiana<br>‚Ä¢ Ver 1 exemplo" }
                        ]
                    },
                    {
                        name: "Ter√ßa 16 Dez",
                        blocks: [
                            { time: "25 min", subject: "üîå Harm√≥nicos<br>‚Ä¢ O que s√£o?<br>‚Ä¢ THD conceito<br>‚Ä¢ Ver forma de onda" },
                            { time: "25 min", subject: "üîå D√≠odos intro<br>‚Ä¢ Curva I-V<br>‚Ä¢ Retificador simples<br>‚Ä¢ Desenha circuito" }
                        ]
                    },
                    {
                        name: "Quarta 17 Dez",
                        blocks: [
                            { time: "25 min", subject: "üåä MHS exerc√≠cios<br>‚Ä¢ T, f, œâ rela√ß√µes<br>‚Ä¢ 2-3 problemas<br>‚Ä¢ Usa f√≥rmulas" },
                            { time: "25 min", subject: "üåä Amortecimento<br>‚Ä¢ Tipos: sub/sobre/cr√≠tico<br>‚Ä¢ Ver gr√°ficos<br>‚Ä¢ Entender diferen√ßas" }
                        ]
                    },
                    {
                        name: "Quinta 18 Dez",
                        blocks: [
                            { time: "üîÅ Retrieval", subject: "‚ö°üîå TESTE MISTO<br>‚Ä¢ 5 min: escreve Gauss<br>‚Ä¢ 5 min: desenha d√≠odo<br>‚Ä¢ Confere e corrige" }
                        ]
                    },
                    {
                        name: "Sexta 19 Dez",
                        blocks: [
                            { time: "30 min", subject: "üåä VIBON Relat√≥rio<br>‚Ä¢ Come√ßar 1 relat√≥rio<br>‚Ä¢ S√≥ estrutura hoje<br>‚Ä¢ Progresso > perfei√ß√£o" }
                        ]
                    },
                    {
                        name: "Fim de Semana 20-21",
                        blocks: [
                            { time: "2h S√°b", subject: "‚ö° Gauss pr√°tica<br>‚Ä¢ 3-4 exerc√≠cios<br>‚Ä¢ Diferentes geometrias<br>‚Ä¢ Anotar passos" },
                            { time: "1h Dom", subject: "üîÅ Semana toda<br>‚Ä¢ Flashcards mentais<br>‚Ä¢ O que lembro?<br>‚Ä¢ Preencher gaps" }
                        ]
                    }
                ]
            },
            // Semana 3: 22-28 Dez ‚Äî Natal (ritmo leve)
            {
                title: "Semana 3 (22-28 Dez) ‚Äî Natal üéÑ",
                days: [
                    {
                        name: "Dom 22 / Seg 23 Dez",
                        blocks: [
                            { time: "30-45 min", subject: "‚ö° Potencial V<br>‚Ä¢ V = W/q conceito<br>‚Ä¢ Rela√ß√£o E e V<br>‚Ä¢ Ritmo relaxado" }
                        ]
                    },
                    {
                        name: "Ter√ßa 24 Dez (V√©spera)",
                        blocks: [
                            { time: "Opcional", subject: "üéÑ V√©spera Natal<br>‚Ä¢ Ver v√≠deo leve<br>‚Ä¢ Ou descansar<br>‚Ä¢ Fam√≠lia primeiro!" }
                        ]
                    },
                    {
                        name: "Quarta 25 Dez",
                        blocks: [
                            { time: "NATAL! üéÑ", subject: "üí§ DESCANSO TOTAL<br>‚Ä¢ Zero estudo<br>‚Ä¢ Aproveita a fam√≠lia<br>‚Ä¢ Feliz Natal!" }
                        ]
                    },
                    {
                        name: "Quinta 26 Dez",
                        blocks: [
                            { time: "30 min", subject: "üîå PWM intro<br>‚Ä¢ O que √© duty cycle?<br>‚Ä¢ Ver anima√ß√£o<br>‚Ä¢ Ritmo leve" }
                        ]
                    },
                    {
                        name: "Sexta 27 Dez",
                        blocks: [
                            { time: "30 min", subject: "üåä Ondas intro<br>‚Ä¢ y(x,t) equa√ß√£o<br>‚Ä¢ Ver onda a propagar<br>‚Ä¢ Conceito visual" }
                        ]
                    },
                    {
                        name: "S√°b-Dom 28-29",
                        blocks: [
                            { time: "1h total", subject: "üìù Relat√≥rio VIBON<br>‚Ä¢ Avan√ßar relat√≥rio<br>‚Ä¢ Sem press√£o<br>‚Ä¢ Qualquer progresso conta" },
                            { time: "Opcional", subject: "üîÅ Mini-revis√£o<br>‚Ä¢ O que lembras?<br>‚Ä¢ Anota gaps<br>‚Ä¢ Prepara Janeiro" }
                        ]
                    }
                ]
            },
            // Semana 4: 29 Dez - 4 Jan ‚Äî Acelerar
            {
                title: "Semana 4 (29 Dez-4 Jan) ‚Äî Acelerar üî•",
                days: [
                    {
                        name: "Dom 29 / Seg 30 Dez",
                        blocks: [
                            { time: "45 min", subject: "‚ö° Ampere + Biot-Savart<br>‚Ä¢ Campo B de fios<br>‚Ä¢ Ver exemplos<br>‚Ä¢ Tentar 1-2 exerc√≠cios" },
                            { time: "30 min", subject: "‚ö° Pr√°tica V e E<br>‚Ä¢ Exerc√≠cios potencial<br>‚Ä¢ Calcular trabalho<br>‚Ä¢ Consolidar" }
                        ]
                    },
                    {
                        name: "Ter√ßa 31 Dez (V√©spera Ano Novo)",
                        blocks: [
                            { time: "30 min manh√£", subject: "üîå Buck converter<br>‚Ä¢ Vo = D√óVin<br>‚Ä¢ Desenha formas onda<br>‚Ä¢ Entender ON/OFF" }
                        ]
                    },
                    {
                        name: "Quarta 1 Jan",
                        blocks: [
                            { time: "ANO NOVO! üéâ", subject: "üí§ Descanso<br>‚Ä¢ Parab√©ns pelo ano novo!<br>‚Ä¢ Amanh√£ voltamos<br>‚Ä¢ 2026 vai correr bem!" }
                        ]
                    },
                    {
                        name: "Quinta 2 Jan",
                        blocks: [
                            { time: "45 min", subject: "üåä Ondas estacion√°rias<br>‚Ä¢ N√≥s e ventres<br>‚Ä¢ Modos normais<br>‚Ä¢ SAI SEMPRE no exame!" },
                            { time: "30 min", subject: "üåä Relat√≥rio<br>‚Ä¢ Continuar relat√≥rio<br>‚Ä¢ Meta: terminar 1 esta semana" }
                        ]
                    },
                    {
                        name: "Sexta 3 Jan",
                        blocks: [
                            { time: "üîÅ 45 min", subject: "RETRIEVAL GERAL<br>‚Ä¢ Fecha tudo<br>‚Ä¢ Escreve: Gauss, Buck, Ondas<br>‚Ä¢ Depois confere!" }
                        ]
                    },
                    {
                        name: "Fim de Semana 4-5 Jan",
                        blocks: [
                            { time: "2h S√°b", subject: "‚ö° Faraday + Indu√ß√£o<br>‚Ä¢ Œµ = -dŒ¶/dt<br>‚Ä¢ Lei de Lenz<br>‚Ä¢ 3-4 exerc√≠cios" },
                            { time: "2h Dom", subject: "üîå Boost + Retificadores<br>‚Ä¢ Vo = Vin/(1-D)<br>‚Ä¢ Circuitos b√°sicos<br>‚Ä¢ Desenhar ondas!" }
                        ]
                    }
                ]
            },
            // Semana 5: 6-12 Jan ‚Äî Intensificar
            {
                title: "Semana 5 (6-12 Jan) ‚Äî Intensivo üí™",
                days: [
                    {
                        name: "Segunda 6 Jan",
                        blocks: [
                            { time: "1h", subject: "‚ö° Maxwell<br>‚Ä¢ As 4 equa√ß√µes!<br>‚Ä¢ ‚àá¬∑E, ‚àá¬∑B, ‚àá√óE, ‚àá√óB<br>‚Ä¢ Significado f√≠sico" },
                            { time: "30 min", subject: "‚ö° Materiais magn√©ticos<br>‚Ä¢ Dia/para/ferro<br>‚Ä¢ Histerese conceito" }
                        ]
                    },
                    {
                        name: "Ter√ßa 7 Jan",
                        blocks: [
                            { time: "1h", subject: "üîå Retificadores avan√ßados<br>‚Ä¢ Controlados (tiristor)<br>‚Ä¢ Semi-controlados<br>‚Ä¢ Controlo de fase" },
                            { time: "30 min", subject: "üîå Formas de onda<br>‚Ä¢ DESENHAR Vo, IL<br>‚Ä¢ Diferentes circuitos<br>‚Ä¢ Praticar muito!" }
                        ]
                    },
                    {
                        name: "Quarta 8 Jan",
                        blocks: [
                            { time: "1h", subject: "üåä Ondas EM + √ìptica<br>‚Ä¢ Maxwell ‚Üí ondas<br>‚Ä¢ Lei de Snell<br>‚Ä¢ Reflex√£o/refra√ß√£o" },
                            { time: "30 min", subject: "üåä Interfer√™ncia<br>‚Ä¢ Construtiva/destrutiva<br>‚Ä¢ Fendas<br>‚Ä¢ Exerc√≠cios" }
                        ]
                    },
                    {
                        name: "Quinta 9 Jan",
                        blocks: [
                            { time: "2h", subject: "üîÅ EXAME ANTIGO #1<br>‚Ä¢ 1 exame Magnetismo<br>‚Ä¢ Cronometrado!<br>‚Ä¢ Anotar erros" }
                        ]
                    },
                    {
                        name: "Sexta 10 Jan",
                        blocks: [
                            { time: "2h", subject: "üîÅ EXAME ANTIGO #2<br>‚Ä¢ 1 exame Pot√™ncia<br>‚Ä¢ Cronometrado!<br>‚Ä¢ Anotar gaps" }
                        ]
                    },
                    {
                        name: "Fim de Semana 11-12 Jan",
                        blocks: [
                            { time: "3h S√°b", subject: "üîÅ EXAME VIBON<br>‚Ä¢ 1 exame completo<br>‚Ä¢ Cronometrado<br>‚Ä¢ Analisar erros" },
                            { time: "2h Dom", subject: "üìù Revis√£o de erros<br>‚Ä¢ Rever onde falhaste<br>‚Ä¢ Refazer exerc√≠cios<br>‚Ä¢ Consolidar gaps" }
                        ]
                    }
                ]
            },
            // Semana 6: 13-18 Jan ‚Äî Revis√£o Final MAGNETISMO
            {
                title: "Semana 6 (13-18 Jan) ‚Äî FOCO: MAGNETISMO ‚ö°",
                days: [
                    {
                        name: "Segunda 13 Jan",
                        blocks: [
                            { time: "2h", subject: "‚ö° Gauss + Ampere<br>‚Ä¢ Exerc√≠cios variados<br>‚Ä¢ Geometrias todas<br>‚Ä¢ Foco total!" },
                            { time: "1h", subject: "‚ö° Faraday + Maxwell<br>‚Ä¢ Indu√ß√£o<br>‚Ä¢ 4 equa√ß√µes<br>‚Ä¢ Significados" }
                        ]
                    },
                    {
                        name: "Ter√ßa 14 Jan",
                        blocks: [
                            { time: "2h", subject: "‚ö° EXAMES ANTIGOS<br>‚Ä¢ 2 exames completos<br>‚Ä¢ Cronometrados<br>‚Ä¢ Simular prova real" },
                            { time: "1h", subject: "‚ö° Revis√£o erros<br>‚Ä¢ Onde falhaste?<br>‚Ä¢ Refazer esses<br>‚Ä¢ Consolidar" }
                        ]
                    },
                    {
                        name: "Quarta 15 Jan",
                        blocks: [
                            { time: "2h", subject: "‚ö° Circuitos magn√©ticos<br>‚Ä¢ Relut√¢ncia<br>‚Ä¢ Analogia el√©trica<br>‚Ä¢ Exerc√≠cios" },
                            { time: "1h", subject: "üîåüåä Manter frescos<br>‚Ä¢ Rever notas Pot/VIBON<br>‚Ä¢ 2-3 exerc√≠cios<br>‚Ä¢ N√£o esquecer!" }
                        ]
                    },
                    {
                        name: "Quinta 16 Jan",
                        blocks: [
                            { time: "3h", subject: "‚ö° SIMULADO FINAL<br>‚Ä¢ Exame completo<br>‚Ä¢ Condi√ß√µes reais<br>‚Ä¢ Tempo controlado" }
                        ]
                    },
                    {
                        name: "Sexta 17 Jan",
                        blocks: [
                            { time: "2h", subject: "‚ö° √öltimas d√∫vidas<br>‚Ä¢ Rever erros simulado<br>‚Ä¢ F√≥rmulas-chave<br>‚Ä¢ Perguntas frequentes" },
                            { time: "1h", subject: "üìù Cart√£o f√≥rmulas<br>‚Ä¢ Lista final<br>‚Ä¢ Tudo numa folha<br>‚Ä¢ Memorizar" }
                        ]
                    },
                    {
                        name: "S√°bado 18 Jan ‚Äî V√âSPERA",
                        blocks: [
                            { time: "Manh√£ leve", subject: "‚ö° Revis√£o final<br>‚Ä¢ Reler cart√£o f√≥rmulas<br>‚Ä¢ 30 min m√°ximo<br>‚Ä¢ SEM MAT√âRIA NOVA!" },
                            { time: "Tarde/Noite", subject: "üí§ DESCANSAR<br>‚Ä¢ Preparar material<br>‚Ä¢ Comer bem<br>‚Ä¢ Dormir cedo<br>‚Ä¢ TU CONSEGUES! üí™" }
                        ]
                    }
                ]
            },
            // Semana 7: 19-25 Jan ‚Äî EXAME MAGNETISMO + Prep POT√äNCIA
            {
                title: "Semana 7 (19-25 Jan) ‚Äî EXAME ‚ö° + Prep üîå",
                days: [
                    {
                        name: "Domingo 19 Jan ‚Äî EXAME! ‚ö°",
                        blocks: [
                            { time: "14:30", subject: "‚ö° EXAME MAGNETISMO<br>‚Ä¢ L√™ TUDO antes<br>‚Ä¢ Come√ßa pelo f√°cil<br>‚Ä¢ Gere bem o tempo<br>‚Ä¢ BOA SORTE! üçÄ" }
                        ]
                    },
                    {
                        name: "Segunda 20 Jan",
                        blocks: [
                            { time: "Manh√£", subject: "üéâ Descomprimir<br>‚Ä¢ Exame feito!<br>‚Ä¢ Descansa um pouco<br>‚Ä¢ Celebra o esfor√ßo" },
                            { time: "Tarde 2h", subject: "üîå Retomar POT√äNCIA<br>‚Ä¢ Rever conversor Buck<br>‚Ä¢ Rever Boost<br>‚Ä¢ Refrescar conceitos" }
                        ]
                    },
                    {
                        name: "Ter√ßa 21 Jan",
                        blocks: [
                            { time: "3h", subject: "üîå Retificadores<br>‚Ä¢ Todos os tipos<br>‚Ä¢ Controlados/n√£o<br>‚Ä¢ DESENHAR ondas!" }
                        ]
                    },
                    {
                        name: "Quarta 22 Jan",
                        blocks: [
                            { time: "3h", subject: "üîå EXAMES ANTIGOS<br>‚Ä¢ 2 exames completos<br>‚Ä¢ Cronometrados<br>‚Ä¢ Anotar erros" }
                        ]
                    },
                    {
                        name: "Quinta 23 Jan",
                        blocks: [
                            { time: "3h", subject: "üîå Revis√£o erros<br>‚Ä¢ Refazer onde falhaste<br>‚Ä¢ THD, fator pot√™ncia<br>‚Ä¢ Formas de onda!" }
                        ]
                    },
                    {
                        name: "Sexta 24 Jan",
                        blocks: [
                            { time: "2h", subject: "üîå SIMULADO<br>‚Ä¢ Exame completo<br>‚Ä¢ Condi√ß√µes reais<br>‚Ä¢ Desenhar TUDO" },
                            { time: "1h", subject: "üìù Cart√£o f√≥rmulas<br>‚Ä¢ Buck, Boost<br>‚Ä¢ Retificadores<br>‚Ä¢ THD, PF" }
                        ]
                    },
                    {
                        name: "S√°bado 25 Jan ‚Äî V√âSPERA",
                        blocks: [
                            { time: "Manh√£", subject: "üîå Revis√£o final<br>‚Ä¢ Reler cart√£o<br>‚Ä¢ 30 min m√°ximo<br>‚Ä¢ SEM NOVO!" },
                            { time: "Tarde/Noite", subject: "üí§ DESCANSAR<br>‚Ä¢ Material pronto<br>‚Ä¢ Comer bem<br>‚Ä¢ Dormir cedo<br>‚Ä¢ AMANH√É √â O DIA! üí™" }
                        ]
                    }
                ]
            },
            // Semana 8: 26-28 Jan ‚Äî EXAMES POT√äNCIA + VIBON
            {
                title: "Semana 8 (26-28 Jan) ‚Äî EXAMES üîåüåä",
                days: [
                    {
                        name: "Domingo 26 Jan ‚Äî EXAME! üîå",
                        blocks: [
                            { time: "Hora TBD", subject: "üîå EXAME POT√äNCIA<br>‚Ä¢ DESENHA os circuitos<br>‚Ä¢ Formas de onda claras<br>‚Ä¢ Unidades corretas<br>‚Ä¢ VAI CORRER BEM! üçÄ" }
                        ]
                    },
                    {
                        name: "Segunda 27 Jan",
                        blocks: [
                            { time: "Manh√£", subject: "üéâ Respira<br>‚Ä¢ Mais um feito!<br>‚Ä¢ Pequena pausa" },
                            { time: "Tarde 3h", subject: "üåä VIBON intensivo<br>‚Ä¢ MHS, ondas, √≥ptica<br>‚Ä¢ Exerc√≠cios-chave<br>‚Ä¢ √öltimas d√∫vidas" }
                        ]
                    },
                    {
                        name: "Ter√ßa 28 Jan ‚Äî EXAME! üåä",
                        blocks: [
                            { time: "Hora TBD", subject: "üåä EXAME VIBON<br>‚Ä¢ L√™ bem o enunciado<br>‚Ä¢ Usa as f√≥rmulas<br>‚Ä¢ Desenha gr√°ficos<br>‚Ä¢ √öLTIMO! FOR√áA! üí™üéâ" }
                        ]
                    },
                    {
                        name: "P√≥s-Exames",
                        blocks: [
                            { time: "üéâ", subject: "PARAB√âNS!<br>‚Ä¢ Acabou a √©poca!<br>‚Ä¢ Descansa bem<br>‚Ä¢ Fizeste o teu melhor<br>‚Ä¢ Celebra! ü•≥üéä" }
                        ]
                    }
                ]
            }
        ];

        let currentWeek = 0;
        let currentNotes = {}; // Store notes for each block
        let currentEditingBlock = null;
        
        /* PESTA task management removed from this page */

        // Notes modal functions
        function openNotes(event, blockIndex) {
            event.stopPropagation(); // Prevent triggering block completion
            currentEditingBlock = blockIndex;
            const modal = document.getElementById('notesModal');
            const textarea = document.getElementById('notesTextarea');
            textarea.value = currentNotes[blockIndex] || '';
            modal.classList.add('open');
            textarea.focus();
        }

        function closeNotes() {
            document.getElementById('notesModal').classList.remove('open');
            currentEditingBlock = null;
        }

        async function saveNotes() {
            const textarea = document.getElementById('notesTextarea');
            const noteText = textarea.value.trim();
            
            if (noteText) {
                currentNotes[currentEditingBlock] = noteText;
            } else {
                delete currentNotes[currentEditingBlock];
            }
            
            closeNotes();
            await saveState();
            renderWeek(currentWeek); // Refresh to show/hide note indicator
        }

        // Close modal on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && currentEditingBlock !== null) {
                closeNotes();
            }
        });

        function renderWeek(weekIndex) {
            const week = weeks[weekIndex];
            const container = document.getElementById('weekContent');
            document.getElementById('weekTitle').textContent = week.title;
            document.getElementById('weekSelector').value = weekIndex;
            
            let blockIndex = 0; // Global block counter
            let html = '';
            week.days.forEach(day => {
                html += `<div class="day-card"><h3>${day.name}</h3>`;
                day.blocks.forEach(block => {
                    const hasNote = currentNotes && currentNotes[blockIndex];
                    html += `
                        <div class="study-block ${hasNote ? 'has-notes' : ''}" onclick="toggleComplete(this)" data-block-index="${blockIndex}">
                            <button class="notes-btn ${hasNote ? 'has-content' : ''}" onclick="openNotes(event, ${blockIndex})" title="Adicionar notas">üìù</button>
                            <span class="time">${block.time}</span>
                            <span class="subject">${block.subject}</span>
                        </div>
                    `;
                    blockIndex++;
                });
                html += '</div>';
            });
            
            container.innerHTML = html;
        }

        function changeWeek(direction) {
            currentWeek += direction;
            if (currentWeek < 0) currentWeek = 0;
            if (currentWeek >= weeks.length) currentWeek = weeks.length - 1;
            renderWeek(currentWeek);
        }

        function selectWeek() {
            currentWeek = parseInt(document.getElementById('weekSelector').value);
            renderWeek(currentWeek);
        }

        // Calculate days until start of exams
        function updateCountdown() {
            const examDate = new Date('2026-01-19T14:30:00');
            const today = new Date();
            const diffTime = examDate - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            document.getElementById('daysLeft').textContent = diffDays;
            
            // (PESTA deadline removed from this page)
        }
        
        /* PESTA organizer and state helpers removed from this page */
        
        // Toggle completion of study blocks
        async function toggleComplete(element) {
            element.classList.toggle('completed');
            await saveState();
        }
        
        // Update progress bars
        async function updateProgress(amount) {
            const subjects = ['electro', 'power', 'vibon'];
            subjects.forEach(subject => {
                const bar = document.getElementById(subject + '-bar');
                const percent = document.getElementById(subject + '-percent');
                let currentValue = parseInt(bar.style.width) || 0;
                currentValue = Math.min(currentValue + amount, 100);
                bar.style.width = currentValue + '%';
                bar.textContent = currentValue + '%';
                percent.textContent = currentValue + '%';
            });
            await saveState();
        }
        
        // Reset progress
        async function resetProgress() {
            if (confirm('Tens a certeza que queres reiniciar o progresso?')) {
                const subjects = ['electro', 'power', 'vibon'];
                subjects.forEach(subject => {
                    const bar = document.getElementById(subject + '-bar');
                    const percent = document.getElementById(subject + '-percent');
                    bar.style.width = '0%';
                    bar.textContent = '0%';
                    percent.textContent = '0%';
                });
                
                document.querySelectorAll('.study-block').forEach(block => {
                    block.classList.remove('completed');
                });
                await saveState();
            }
        }
        
        // Save state to localStorage and Firebase
        async function saveState() {
            const state = {
                electro: document.getElementById('electro-bar').style.width,
                power: document.getElementById('power-bar').style.width,
                vibon: document.getElementById('vibon-bar').style.width,
                completed: [],
                notes: currentNotes // Save notes
            };
            
            document.querySelectorAll('.study-block.completed').forEach((block, index) => {
                state.completed.push(index);
            });
            
            // Save to localStorage (backup)
            localStorage.setItem('studyProgress', JSON.stringify(state));
            
            // Save to Firebase
            if (firebaseEnabled) {
                try {
                    await db.collection('rotina').doc('progress').set({
                        data: state,
                        lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    console.log('‚úÖ Progresso guardado no Firebase');
                } catch (error) {
                    console.error('‚ùå Erro ao guardar no Firebase:', error);
                }
            }
        }
        
        // Load state from Firebase or localStorage
        async function loadState() {
            let state = null;
            
            // Try Firebase first
            if (firebaseEnabled) {
                try {
                    const doc = await db.collection('rotina').doc('progress').get();
                    if (doc.exists) {
                        state = doc.data().data;
                        console.log('‚úÖ Progresso carregado do Firebase');
                        // Also save to localStorage as backup
                        localStorage.setItem('studyProgress', JSON.stringify(state));
                    }
                } catch (error) {
                    console.error('‚ùå Erro ao carregar do Firebase:', error);
                }
            }
            
            // Fallback to localStorage
            if (!state) {
                const saved = localStorage.getItem('studyProgress');
                if (saved) {
                    state = JSON.parse(saved);
                }
            }
            
            // Apply state to UI
            if (state) {
                ['electro', 'power', 'vibon'].forEach(subject => {
                    const bar = document.getElementById(subject + '-bar');
                    const percent = document.getElementById(subject + '-percent');
                    bar.style.width = state[subject] || '0%';
                    bar.textContent = state[subject] || '0%';
                    percent.textContent = state[subject] || '0%';
                });
                
                // Load notes
                currentNotes = state.notes || {};
                
                const blocks = document.querySelectorAll('.study-block');
                state.completed.forEach(index => {
                    if (blocks[index]) {
                        blocks[index].classList.add('completed');
                    }
                });
            }
        }
        
        // Download schedule as text
        function downloadSchedule() {
            const text = `
ROTINA DE ESTUDOS - EXAMES JANEIRO 2025
========================================

HOR√ÅRIOS DISPON√çVEIS:
- Segunda, Ter√ßa, Quarta: 18:00-20:00
- Fins de semana: Flex√≠vel (3-4 horas)

ROTA√á√ÉO SEMANAL:
Semana 1, 4, 7, 10: Seg-Eletromag | Ter-Eletr√≥nica | Qua-VIBON
Semana 2, 5, 8: Seg-Eletr√≥nica | Ter-VIBON | Qua-Eletromag
Semana 3, 6, 9: Seg-VIBON | Ter-Eletromag | Qua-Eletr√≥nica

PRIORIDADES:
‚úì Eletromagnetismo: Exerc√≠cios pr√°ticos intensivos
‚úì Eletr√≥nica Pot√™ncia: Simula√ß√µes e problemas
‚úì VIBON: Relat√≥rios aos fins de semana + teoria

DICAS:
- T√©cnica Pomodoro: 25min estudo + 5min pausa
- Relat√≥rios VIBON: 1 por fim de semana
- Dezembro: Come√ßar exames anteriores
- Janeiro: Revis√£o intensiva final
            `;
            
            const blob = new Blob([text], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'rotina_estudos_janeiro2025.txt';
            a.click();
        }
        
        // Initialize
        async function init() {
            updateCountdown();
            await loadState();
            renderWeek(0); // Load first week on start
            setInterval(updateCountdown, 3600000); // Update every hour
        }
        
        init();
    </script>
</body>
</html>